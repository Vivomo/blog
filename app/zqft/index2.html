<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>zqft</title>
</head>
<body>

<script>
    let 创建产品 = (花费, 日利润) => ({花费, 日利润, 剩余周期: 90});
    let 限制 = {
        100000: 1,
        10000: 1,
        5000: 1,
        1000: 2,
        500: 2,
        100: 4,
        10: 8
    };
    let 产品列表 = [
        创建产品(100000, 1520),
        创建产品(10000, 148),
        创建产品(5000, 72),
        创建产品(1000, 14),
        创建产品(500, 6.8),
        创建产品(100, 1.32),
        创建产品(10, 0.132),
    ];


    let 安乐 = {
        积分: 10000,
        已买的产品: [],
        刚买的产品: [],
        买(产品) {
            this.刚买的产品.push({...产品});
        },
        收益刚买产品的积分() {
            this.刚买的产品.forEach(产品 => {
                this.积分 += 产品.日利润;
                产品.剩余周期 -= 1;
            });
            this.已买的产品 = this.已买的产品.concat(...this.刚买的产品);
            this.刚买的产品 = [];
        },
        收益已买产品的积分() {
            this.已买的产品.forEach(产品 => {
                this.积分 += 产品.日利润;
                产品.剩余周期 -= 1;
            });
        },
        看看能不能买点啥(第几天) {
            let 买了 = false;
            产品列表.forEach(产品 => {
                if (产品.花费 <= 安乐.积分) {
                    if (安乐.已买的产品.filter(已买产品 => 已买产品.花费 === 产品.花费).length < 限制[产品.花费]) {
                        安乐.买(产品);
                        console.log(`第${第几天}天买了`,{...产品})
                        安乐.积分 -= 产品.花费;
                        买了 = true;
                    }
                }
            });
            return 买了;
        },
        清除到期产品() {
            this.已买的产品 = this.已买的产品.filter(产品 => 产品.剩余周期 > 0);
        },
        能买就买(天数) {
            for (let 天 = 1; 天 <= 天数; 天++) {
                this.收益已买产品的积分();
                while (this.看看能不能买点啥(天)) {
                    this.收益刚买产品的积分();
                }
                this.清除到期产品();
                console.log(`第${天}天的积分`, this.积分)
            }
        },
    };
    console.time('a')
    安乐.能买就买(90);
    console.timeEnd('a')
</script>
</body>
</html>